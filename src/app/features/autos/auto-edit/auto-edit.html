<div class="container">
  <div class="form-header">
    <h1>Editar Auto: {{ auto?.marca }} {{ auto?.modelo }}</h1>
    <button class="btn btn-secondary" (click)="volver()">← Volver</button>
  </div>

  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Cargando auto...</p>
  </div>

  <div *ngIf="error" class="alert alert-error">{{ error }}</div>
  <div *ngIf="success" class="alert alert-success">{{ success }}</div>

  <form *ngIf="!loading && auto" (ngSubmit)="onSubmit()" #autoForm="ngForm" class="auto-form">
    
    <!-- Información Básica -->
    <div class="form-section">
      <h3>Información Básica</h3>
      <div class="form-grid">
        <div class="form-group">
          <label for="marca">Marca *</label>
          <input type="text" id="marca" name="marca" [(ngModel)]="autoEditado.marca" required>
        </div>

        <div class="form-group">
          <label for="modelo">Modelo *</label>
          <input type="text" id="modelo" name="modelo" [(ngModel)]="autoEditado.modelo" required>
        </div>

        <div class="form-group">
          <label for="anio">Año *</label>
          <input type="number" id="anio" name="anio" [(ngModel)]="autoEditado.anio" min="2000" max="2030" required>
        </div>

        <div class="form-group">
          <label for="precio">Precio ($) *</label>
          <input type="number" id="precio" name="precio" [(ngModel)]="autoEditado.precio" min="0" step="0.01" required>
        </div>

        <div class="form-group">
          <label for="color">Color</label>
          <input type="text" id="color" name="color" [(ngModel)]="autoEditado.color">
        </div>

        <div class="form-group">
          <label for="kilometraje">Kilometraje</label>
          <input type="number" id="kilometraje" name="kilometraje" [(ngModel)]="autoEditado.kilometraje" min="0">
        </div>
      </div>
    </div>

    <!-- Especificaciones -->
    <div class="form-section">
      <h3>Especificaciones</h3>
      <div class="form-grid">
        <div class="form-group">
          <label for="combustible">Combustible</label>
          <select id="combustible" name="combustible" [(ngModel)]="autoEditado.combustible">
            <option *ngFor="let comb of combustibles" [value]="comb">{{ comb }}</option>
          </select>
        </div>

        <div class="form-group">
          <label for="transmision">Transmisión</label>
          <select id="transmision" name="transmision" [(ngModel)]="autoEditado.transmision">
            <option *ngFor="let trans of transmisiones" [value]="trans">{{ trans }}</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Descripción -->
    <div class="form-section">
      <h3>Descripción</h3>
      <div class="form-group">
        <textarea 
          id="descripcion" 
          name="descripcion" 
          [(ngModel)]="autoEditado.descripcion" 
          placeholder="Describe el auto, características, estado, etc..."
          rows="4">
        </textarea>
      </div>
    </div>

    <!-- Imágenes -->
    <div class="form-section">
      <div class="section-header">
        <h3>Imágenes del Auto</h3>
        <button type="button" class="btn btn-outline" (click)="agregarImagen()">+ Agregar Imagen</button>
      </div>
      
      <div *ngFor="let imagen of autoEditado.imagenes; let i = index" class="image-input-group">
        <div class="image-input">
          <label>URL de Imagen {{ i + 1 }}</label>
          <input 
            type="url" 
            [name]="'imagen' + i"
            [(ngModel)]="autoEditado.imagenes[i]" 
            placeholder="https://ejemplo.com/imagen.jpg">
        </div>
        <button 
          type="button" 
          class="btn btn-danger" 
          (click)="eliminarImagen(i)"
          *ngIf="autoEditado.imagenes.length > 1">
          ✕
        </button>
      </div>
      
      <p class="help-text">Agrega URLs de imágenes del auto. Mínimo 1 imagen.</p>
    </div>

    <!-- Botones -->
    <div class="form-actions">
      <button type="button" class="btn btn-secondary" (click)="volver()">Cancelar</button>
      <button 
        type="submit" 
        class="btn btn-primary" 
        [disabled]="saving || !autoEditado.marca || !autoEditado.modelo || !autoEditado.anio || !autoEditado.precio">
        {{ saving ? 'Guardando...' : 'Guardar Cambios' }}
      </button>
    </div>
  </form>
</div>